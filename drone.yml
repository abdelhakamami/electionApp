kind: pipeline
name: build-and-push
type: kubernetes


platform:
  os: linux
  arch: amd64

steps:
  

  - name: push-image-backend
    image: plugins/kaniko
    settings:
      registry: docker.io/abdelhakavaxia
      repo: abdelhakavaxia
      username:
        from_secret: abdelhakavaxia
      password:
        from_secret: docker_password
      dockerfile: ./back-end/Dockerfile 

  - name: build-image-frontend
    image: docker:latest
    commands:
      - docker build -t frontend-image-:dev -f ./front-end/Dockerfile .

  - name: push-image-frontend
    image: plugins/docker
    settings:
      repository: abdelhakavaxia
      tag: dev
      registry: docker.io
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
